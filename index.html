<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Gerador de Ficha - JJK RPG</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;700&family=Roboto+Mono:wght@400;700&family=Yuji+Syuku&display=swap" rel="stylesheet">
  
  <style>
    :root {
      --bg: #0c0c1a;
      --panel: #13141c;
      --muted: #bfc6e6;
      --accent1: #9b00ff;
      --highlight: #c48fff;
      --text: #e7e9ff;
      --ui: 'Inter', system-ui, sans-serif;
      --title: 'Yuji Syuku', serif;
      --mono: 'Roboto Mono', monospace;
      --failure: #c53030;
      --glass: rgba(255, 255, 255, 0.03);
      --glass-2: rgba(255, 255, 255, 0.02);
      --success: #00e091;
    }
    body {
      font-family: var(--ui);
      background-color: var(--bg);
      color: var(--text);
      line-height: 1.6;
      padding: 20px;
    }
    .container {
      max-width: 900px;
      margin: 0 auto;
    }
    #form-container {
      background: var(--panel);
      border-radius: 10px;
      border: 1px solid rgba(255, 255, 255, 0.1);
      padding: 20px;
    }
    #output-container {
      margin-top: 20px;
    }
    fieldset {
      border: 1px solid var(--glass);
      border-radius: 8px;
      padding: 15px;
      margin-bottom: 20px;
    }
    legend {
      font-family: var(--title);
      font-size: 1.5em;
      color: var(--highlight);
      padding: 0 10px;
      margin-left: 10px;
    }
    .grid-2 { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
    .grid-3 { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 15px; }
    .grid-4 { display: grid; grid-template-columns: 1fr 1fr 1fr 1fr; gap: 15px; }
    .grid-5 { display: grid; grid-template-columns: repeat(5, 1fr); gap: 15px; }
    .input-group { display: flex; flex-direction: column; gap: 5px; margin-bottom: 10px; }
    label { font-weight: 500; font-size: 13px; color: var(--muted); text-transform: uppercase; font-family: var(--mono); }
    
    /* --- LINHA CORRIGIDA --- */
    input[type="text"], input[type="url"], input[type="number"], textarea, select {
      background: var(--bg);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 6px;
      padding: 10px;
      color: var(--text);
      font-family: var(--ui);
      font-size: 14px;
      /* --- ADICIONADO PARA CORRIGIR O OVERFLOW --- */
      box-sizing: border-box; 
      width: 100%;
      min-width: 0;
    }
    /* --- FIM DA CORREÇÃO --- */

    input[type="number"], select, input[placeholder*="XP"] { font-family: var(--mono); }
    textarea { min-height: 80px; resize: vertical; }
    .note { font-size: 12px; color: var(--muted); opacity: 0.8; margin-top: -5px; margin-bottom: 10px; }
    h4 {
      font-family: var(--title);
      color: var(--highlight);
      border-bottom: 1px solid var(--glass-2);
      padding-bottom: 5px;
      margin-top: 15px;
      margin-bottom: 10px;
      font-size: 1.1em;
    }
    .dynamic-item-set {
      border: 1px solid var(--glass-2);
      border-radius: 6px;
      padding: 10px;
      margin-bottom: 10px;
      background: var(--bg);
    }
    #output-code {
      width: 100%;
      height: 150px;
      background: var(--bg);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 8px;
      padding: 15px;
      color: var(--muted);
      font-family: var(--mono);
      font-size: 12px;
      resize: vertical;
      margin-bottom: 10px;
    }
    #copy-btn {
      width: 100%; padding: 10px; border: none; border-radius: 8px; background: var(--success);
      color: var(--panel); font-size: 1em; font-family: var(--ui); font-weight: 700;
      cursor: pointer; transition: background 0.2s;
    }
    #copy-btn:hover { background: #00ffaa; }
    
    textarea::-webkit-scrollbar { width: 8px; }
    textarea::-webkit-scrollbar-track { background: var(--panel); }
    textarea::-webkit-scrollbar-thumb { background-color: var(--accent1); border-radius: 8px; }
    
    @media (max-width: 600px) {
      .grid-2, .grid-3, .grid-4, .grid-5 { grid-template-columns: 1fr; }
    }
  </style>
</head>
<body>

  <div class="container">
    
    <div id="form-container">
      <fieldset>
        <legend>Cabeçalho</legend>
        <div class="input-group">
          <label for="f-char-name">Nome do Personagem</label>
          <input type="text" id="f-char-name" placeholder="Ex: Yuji Itadori">
        </div>
        <div class="input-group">
          <label for="f-char-title">Título/Alcunha</label>
          <input type="text" id="f-char-title" placeholder="Ex: O Receptáculo de Ryomen Sukuna">
        </div>
        <div class="input-group">
          <label for="f-profile-img">URL da Imagem de Perfil</label>
          <input type="url" id="f-profile-img" placeholder="https://... .jpg">
        </div>

        <div class="grid-5">
            <div class="input-group">
              <label for="f-hp-atual">HP Atual</label>
              <input type="number" id="f-hp-atual" value="400">
            </div>
            <div class="input-group">
              <label for="f-hp-max">HP Máximo</label>
              <input type="number" id="f-hp-max" value="400">
            </div>
            <div class="input-group">
              <label for="f-ea-atual">EA Atual</label>
              <input type="number" id="f-ea-atual" value="400">
            </div>
            <div class="input-group">
              <label for="f-ea-max">EA Máxima</label>
              <input type="number" id="f-ea-max" value="400">
            </div>
            <div class="input-group">
              <label for="f-regen-ea">Regen. EA</label>
              <input type="number" id="f-regen-ea" value="40">
            </div>
        </div>
        <div class="grid-4">
          <div class="input-group">
            <label for="f-idade">Idade</label>
            <input type="text" id="f-idade" placeholder="Ex: 15">
          </div>
          <div class="input-group">
            <label for="f-grau">Grau</label>
            <input type="text" id="f-grau" placeholder="Ex: Estudante">
          </div>
          <div class="input-group">
            <label for="f-afiliacao">Afiliação</label>
            <input type="text" id="f-afiliacao" placeholder="Ex: Escola de Tóquio">
          </div>
          <div class="input-group">
            <label for="f-alinhamento">Alinhamento</label>
            <select id="f-alinhamento">
              <option value="Leal e Bom">Leal e Bom</option>
              <option value="Neutro e Bom">Neutro e Bom</option>
              <option value="Caótico e Bom">Caótico e Bom</option>
              <option value="Leal e Neutro">Leal e Neutro</option>
              <option value="Neutro Verdadeiro" selected>Neutro Verdadeiro</option>
              <option value="Caótico e Neutro">Caótico e Neutro</option>
              <option value="Leal e Mau">Leal e Mau</option>
              <option value="Neutro e Mau">Neutro e Mau</option>
              <option value="Caótico e Mau">Caótico e Mau</option>
            </select>
          </div>
        </div>
      </fieldset>

      <fieldset>
        <legend>Atributos (1-20)</legend>
        <p class="note">Vigor, Energia e Fonte são usados apenas para referência de nível. O HP/EA/Regen são definidos no Cabeçalho.</p>
        <div class="grid-4">
          <div class="input-group"><label for="f-forca">Força (FOR)</label><input type="number" id="f-forca" value="1" min="1" max="20"></div>
          <div class="input-group"><label for="f-destreza">Destreza (DES)</label><input type="number" id="f-destreza" value="1" min="1" max="20"></div>
          <div class="input-group"><label for="f-inteligencia">Inteligência (INT)</label><input type="number" id="f-inteligencia" value="1" min="1" max="20"></div>
          <div class="input-group"><label for="f-sorte">Sorte (SOR)</label><input type="number" id="f-sorte" value="1" min="1" max="20"></div>
        </div>
        <hr style="border-color: var(--glass); margin: 15px 0;">
        <div class="grid-3">
          <div class="input-group"><label for="f-vigor">Vigor (VIG)</label><input type="number" id="f-vigor" value="1" min="1" max="20"></div>
          <div class="input-group"><label for="f-energia">Energia (ENE)</label><input type="number" id="f-energia" value="1" min="1" max="20"></div>
          <div class="input-group"><label for="f-fonte">Fonte (FON)</label><input type="number" id="f-fonte" value="1" min="1" max="20"></div>
        </div>
      </fieldset>

      <fieldset>
        <legend>Aptidões</legend>
        <p class="note">Digite o Nível (0-50) e o valor de XP (Ex: 0 / 200 XP).</p>
        <h3>Força (FOR)</h3>
        <div class="grid-2">
          <div class="input-group"><label>Combate Desarmado (Nível)</label><input type="number" id="f-skill-combate-desarmado-lvl" value="0" min="0" max="50"></div>
          <div class="input-group"><label>Combate Desarmado (XP)</label><input type="text" id="f-skill-combate-desarmado-xp" value="0 / 200 XP"></div>
          <div class="input-group"><label>Espadas Longas (Nível)</label><input type="number" id="f-skill-espadas-longas-lvl" value="0" min="0" max="50"></div>
          <div class="input-group"><label>Espadas Longas (XP)</label><input type="text" id="f-skill-espadas-longas-xp" value="0 / 200 XP"></div>
          <div class="input-group"><label>Machados Longos (Nível)</label><input type="number" id="f-skill-machados-longos-lvl" value="0" min="0" max="50"></div>
          <div class="input-group"><label>Machados Longos (XP)</label><input type="text" id="f-skill-machados-longos-xp" value="0 / 200 XP"></div>
          <div class="input-group"><label>Martelos Longos (Nível)</label><input type="number" id="f-skill-martelos-longos-lvl" value="0" min="0" max="50"></div>
          <div class="input-group"><label>Martelos Longos (XP)</label><input type="text" id="f-skill-martelos-longos-xp" value="0 / 200 XP"></div>
          <div class="input-group"><label>Clavas (Nível)</label><input type="number" id="f-skill-clavas-lvl" value="0" min="0" max="50"></div>
          <div class="input-group"><label>Clavas (XP)</label><input type="text" id="f-skill-clavas-xp" value="0 / 200 XP"></div>
          <div class="input-group"><label>Escalada (Nível)</label><input type="number" id="f-skill-escalada-lvl" value="0" min="0" max="50"></div>
          <div class="input-group"><label>Escalada (XP)</label><input type="text" id="f-skill-escalada-xp" value="0 / 200 XP"></div>
          <div class="input-group"><label>Acrobacia (Nível)</label><input type="number" id="f-skill-acrobacia-lvl" value="0" min="0" max="50"></div>
          <div class="input-group"><label>Acrobacia (XP)</label><input type="text" id="f-skill-acrobacia-xp" value="0 / 200 XP"></div>
        </div>
        <hr style="border-color: var(--glass); margin: 15px 0;">
        <h3>Destreza (DES)</h3>
        <div class="grid-2">
          <div class="input-group"><label>Espadas Curtas (Nível)</label><input type="number" id="f-skill-espadas-curtas-lvl" value="0" min="0" max="50"></div>
          <div class="input-group"><label>Espadas Curtas (XP)</label><input type="text" id="f-skill-espadas-curtas-xp" value="0 / 200 XP"></div>
          <div class="input-group"><label>Adagas (Nível)</label><input type="number" id="f-skill-adagas-lvl" value="0" min="0" max="50"></div>
          <div class="input-group"><label>Adagas (XP)</label><input type="text" id="f-skill-adagas-xp" value="0 / 200 XP"></div>
          <div class="input-group"><label>Lâminas Duplas (Nível)</label><input type="number" id="f-skill-laminas-duplas-lvl" value="0" min="0" max="50"></div>
          <div class="input-group"><label>Lâminas Duplas (XP)</label><input type="text" id="f-skill-laminas-duplas-xp" value="0 / 200 XP"></div>
          <div class="input-group"><label>Machados Curtos (Nível)</label><input type="number" id="f-skill-machados-curtos-lvl" value="0" min="0" max="50"></div>
          <div class="input-group"><label>Machados Curtos (XP)</label><input type="text" id="f-skill-machados-curtos-xp" value="0 / 200 XP"></div>
          <div class="input-group"><label>Martelos Curtos (Nível)</label><input type="number" id="f-skill-martelos-curtos-lvl" value="0" min="0" max="50"></div>
          <div class="input-group"><label>Martelos Curtos (XP)</label><input type="text" id="f-skill-martelos-curtos-xp" value="0 / 200 XP"></div>
          <div class="input-group"><label>Lanças (Nível)</label><input type="number" id="f-skill-lancas-lvl" value="0" min="0" max="50"></div>
          <div class="input-group"><label>Lanças (XP)</label><input type="text" id="f-skill-lancas-xp" value="0 / 200 XP"></div>
          <div class="input-group"><label>Foices (Nível)</label><input type="number" id="f-skill-foices-lvl" value="0" min="0" max="50"></div>
          <div class="input-group"><label>Foices (XP)</label><input type="text" id="f-skill-foices-xp" value="0 / 200 XP"></div>
          <div class="input-group"><label>Bastões (Nível)</label><input type="number" id="f-skill-bastoes-lvl" value="0" min="0" max="50"></div>
          <div class="input-group"><label>Bastões (XP)</label><input type="text" id="f-skill-bastoes-xp" value="0 / 200 XP"></div>
          <div class="input-group"><label>Correntes (Nível)</label><input type="number" id="f-skill-correntes-lvl" value="0" min="0" max="50"></div>
          <div class="input-group"><label>Correntes (XP)</label><input type="text" id="f-skill-correntes-xp" value="0 / 200 XP"></div>
          <div class="input-group"><label>Arremesso (Nível)</label><input type="number" id="f-skill-arremesso-lvl" value="0" min="0" max="50"></div>
          <div class="input-group"><label>Arremesso (XP)</label><input type="text" id="f-skill-arremesso-xp" value="0 / 200 XP"></div>
          <div class="input-group"><label>Armas de Fogo (Nível)</label><input type="number" id="f-skill-armas-de-fogo-lvl" value="0" min="0" max="50"></div>
          <div class="input-group"><label>Armas de Fogo (XP)</label><input type="text" id="f-skill-armas-de-fogo-xp" value="0 / 200 XP"></div>
          <div class="input-group"><label>Furtividade (Nível)</label><input type="number" id="f-skill-furtividade-lvl" value="0" min="0" max="50"></div>
          <div class="input-group"><label>Furtividade (XP)</label><input type="text" id="f-skill-furtividade-xp" value="0 / 200 XP"></div>
          <div class="input-group"><label>Natação (Nível)</label><input type="number" id="f-skill-natacao-lvl" value="0" min="0" max="50"></div>
          <div class="input-group"><label>Natação (XP)</label><input type="text" id="f-skill-natacao-xp" value="0 / 200 XP"></div>
          <div class="input-group"><label>Corrida (Nível)</label><input type="number" id="f-skill-corrida-lvl" value="0" min="0" max="50"></div>
          <div class="input-group"><label>Corrida (XP)</label><input type="text" id="f-skill-corrida-xp" value="0 / 200 XP"></div>
        </div>
        <hr style="border-color: var(--glass); margin: 15px 0;">
        <h3>Inteligência (INT)</h3>
        <div class="grid-2">
          <div class="input-group"><label>Feitiços (Nível)</label><input type="number" id="f-skill-feiticos-lvl" value="0" min="0" max="50"></div>
          <div class="input-group"><label>Feitiços (XP)</label><input type="text" id="f-skill-feiticos-xp" value="0 / 200 XP"></div>
          <div class="input-group"><label>Barreiras (Nível)</label><input type="number" id="f-skill-barreiras-lvl" value="0" min="0" max="50"></div>
          <div class="input-group"><label>Barreiras (XP)</label><input type="text" id="f-skill-barreiras-xp" value="0 / 200 XP"></div>
          <div class="input-group"><label>Pactos (Nível)</label><input type="number" id="f-skill-pactos-lvl" value="0" min="0" max="50"></div>
          <div class="input-group"><label>Pactos (XP)</label><input type="text" id="f-skill-pactos-xp" value="0 / 200 XP"></div>
          <div class="input-group"><label>Percepção Mágica (Nível)</label><input type="number" id="f-skill-percepcao-magica-lvl" value="0" min="0" max="50"></div>
          <div class="input-group"><label>Percepção Mágica (XP)</label><input type="text" id="f-skill-percepcao-magica-xp" value="0 / 200 XP"></div>
          <div class="input-group"><label>Primeiros Socorros (Nível)</label><input type="number" id="f-skill-primeiros-socorros-lvl" value="0" min="0" max="50"></div>
          <div class="input-group"><label>Primeiros Socorros (XP)</label><input type="text" id="f-skill-primeiros-socorros-xp" value="0 / 200 XP"></div>
          <div class="input-group"><label>Técnica Reversa (Nível)</label><input type="number" id="f-skill-tecnica-reversa-lvl" value="0" min="0" max="50"></div>
          <div class="input-group"><label>Técnica Reversa (XP)</label><input type="text" id="f-skill-tecnica-reversa-xp" value="0 / 200 XP"></div>
          <div class="input-group"><label>Percepção Visual (Nível)</label><input type="number" id="f-skill-percepcao-visual-lvl" value="0" min="0" max="50"></div>
          <div class="input-group"><label>Percepção Visual (XP)</label><input type="text" id="f-skill-percepcao-visual-xp" value="0 / 200 XP"></div>
          <div class="input-group"><label>Sobrevivência (Nível)</label><input type="number" id="f-skill-sobrevivencia-lvl" value="0" min="0" max="50"></div>
          <div class="input-group"><label>Sobrevivência (XP)</label><input type="text" id="f-skill-sobrevivencia-xp" value="0 / 200 XP"></div>
        </div>
      </fieldset>
      <fieldset>
        <legend>Combate</legend>
        <h4>Técnicas</h4>
        <p class="note">Preencha quantos slots precisar. Os vazios serão ignorados.</p>
        <div class="dynamic-item-set"><div class="grid-2"><div class="input-group"><label>Técnica 1: Nome</label><input type="text" id="f-tecnica-nome-1" placeholder="Ex: Punho Divergente"></div><div class="input-group"><label>Técnica 1: URL</label><input type="url" id="f-tecnica-url-1" placeholder="https://... (opcional)"></div></div></div>
        <div class="dynamic-item-set"><div class="grid-2"><div class="input-group"><label>Técnica 2: Nome</label><input type="text" id="f-tecnica-nome-2" placeholder="Ex: Clarão Negro"></div><div class="input-group"><label>Técnica 2: URL</label><input type="url" id="f-tecnica-url-2" placeholder="https://... (opcional)"></div></div></div>
        <div class="dynamic-item-set"><div class="grid-2"><div class="input-group"><label>Técnica 3: Nome</label><input type="text" id="f-tecnica-nome-3"></div><div class="input-group"><label>Técnica 3: URL</label><input type="url" id="f-tecnica-url-3"></div></div></div>
        <div class="dynamic-item-set"><div class="grid-2"><div class="input-group"><label>Técnica 4: Nome</label><input type="text" id="f-tecnica-nome-4"></div><div class="input-group"><label>Técnica 4: URL</label><input type="url" id="f-tecnica-url-4"></div></div></div>
        <div class="dynamic-item-set"><div class="grid-2"><div class="input-group"><label>Técnica 5: Nome</label><input type="text" id="f-tecnica-nome-5"></div><div class="input-group"><label>Técnica 5: URL</label><input type="url" id="f-tecnica-url-5"></div></div></div>
        
        <h4 style="margin-top: 20px;">Equipamentos</h4>
        <p class="note">Um por linha. Deixe vazio para pular.</p>
        <textarea id="f-equipamentos" placeholder="Ex: Uniforme da Escola Jujutsu"></textarea>
      </fieldset>
      
      <fieldset>
        <legend>Características</legend>
        <div class="grid-2">
          <div class="input-group">
            <label for="f-carac-p">Positivas (Uma por linha)</label>
            <textarea id="f-carac-p" placeholder="Ex: Força Elevada (2 pts)"></textarea>
          </div>
          <div class="input-group">
            <label for="f-carac-n">Negativas (Uma por linha)</label>
            <textarea id="f-carac-n" placeholder="Ex: Impulsividade (5 pts)"></textarea>
          </div>
        </div>
      </fieldset>

      <fieldset>
        <legend>Perfil</legend>
        <div class="input-group">
          <label for="f-particularidade-nome">Particularidade (Apenas UMA)</label>
          <input type="text" id="f-particularidade-nome" placeholder="Ex: Receptáculo Amaldiçoado">
        </div>
        <div class="input-group">
          <label for="f-particularidade-url">URL da Particularidade</label>
          <input type="url" id="f-particularidade-url" placeholder="https://... (opcional)">
        </div>
        <div class="input-group">
          <label for="f-particularidade-desc">Descrição IC da Particularidade</label>
          <input type="text" id="f-particularidade-desc" placeholder="Ex: Hospedeiro de Ryomen Sukuna">
        </div>
        
        <hr style="border-color: var(--glass); margin: 15px 0;">
        <div class="input-group">
          <label for="f-aparencia">Aparência Geral</label>
          <textarea id="f-aparencia" placeholder="Descreva a aparência física do seu personagem..."></textarea>
        </div>
        <div class="grid-3">
          <div class="input-group"> <label>Altura</label> <input type="text" id="f-altura" placeholder="Ex: 173 cm"> </div>
          <div class="input-group"> <label>Peso</label> <input type="text" id="f-peso" placeholder="Ex: 80 kg"> </div>
          <div class="input-group"> <label>Olhos</label> <input type="text" id="f-olhos" placeholder="Ex: Castanho Claro"> </div>
          <div class="input-group"> <label>Cabelo</label> <input type="text" id="f-cabelo" placeholder="Ex: Rosa (Tingido)"> </div>
          <div class="input-group"> <label>Pele</label> <input type="text" id="f-pele" placeholder="Ex: Clara"> </div>
        </div>
        
        <hr style="border-color: var(--glass); margin: 15px 0;">
        <div class="grid-2">
          <div class="input-group"> <label for="f-gostos">Gostos (Um por linha)</label> <textarea id="f-gostos" placeholder="Ex: Filmes de ação"></textarea> </div>
          <div class="input-group"> <label for="f-desgostos">Desgostos (Um por linha)</label> <textarea id="f-desgostos" placeholder="Ex: Ficar sozinho"></textarea> </div>
          <div class="input-group"> <label for="f-medos">Medos (Um por linha)</label> <textarea id="f-medos" placeholder="Ex: Não ser capaz de salvar a todos"></textarea> </div>
          <div class="input-group"> <label for="f-objetivos">Objetivos (Um por linha)</label> <textarea id="f-objetivos" placeholder="Ex: Consumir todos os dedos de Sukuna"></textarea> </div>
        </div>
      </fieldset>

      <fieldset>
        <legend>Relações</legend>
        <p class="note">Preencha quantos slots precisar. Os vazios serão ignorados.</p>
        <div class="dynamic-item-set relacao-item">
          <div class="grid-2">
            <div class="input-group"><label>Relação 1: Nome</label><input type="text" id="f-rel-nome-1" placeholder="Ex: Megumi Fushiguro"></div>
            <div class="input-group"><label>Relação 1: Status</label><input type="text" id="f-rel-status-1" placeholder="Ex: Aliado, Rival"></div>
          </div>
          <div class="input-group"><label>Relação 1: Descrição</label><textarea id="f-rel-desc-1" rows="2" placeholder="Primeiro feiticeiro que conheceu..."></textarea></div>
        </div>
        <div class="dynamic-item-set relacao-item">
          <div class="grid-2">
            <div class="input-group"><label>Relação 2: Nome</label><input type="text" id="f-rel-nome-2"></div>
            <div class="input-group"><label>Relação 2: Status</label><input type="text" id="f-rel-status-2"></div>
          </div>
          <div class="input-group"><label>Relação 2: Descrição</label><textarea id="f-rel-desc-2" rows="2"></textarea></div>
        </div>
        <div class="dynamic-item-set relacao-item">
          <div class="grid-2">
            <div class="input-group"><label>Relação 3: Nome</label><input type="text" id="f-rel-nome-3"></div>
            <div class="input-group"><label>Relação 3: Status</label><input type="text" id="f-rel-status-3"></div>
          </div>
          <div class="input-group"><label>Relação 3: Descrição</label><textarea id="f-rel-desc-3" rows="2"></textarea></div>
        </div>
      </fieldset>

      <fieldset>
        <legend>Inventário e Biografia</legend>
        <h4>Inventário</h4>
        <p class="note">Formato: [Nome] | [Descrição Tooltip]. Slots vazios serão ignorados.</p>
        <div class="grid-2">
          <div class="input-group"><label>Item 1</label><input type="text" id="f-inv-1" placeholder="Ex: Celular | Um smartphone comum..."></div>
          <div class="input-group"><label>Item 2</label><input type="text" id="f-inv-2" placeholder="Ex: Faca Amaldiçoada | ..."></div>
          <div class="input-group"><label>Item 3</label><input type="text" id="f-inv-3"></div>
          <div class="input-group"><label>Item 4</label><input type="text" id="f-inv-4"></div>
          <div class="input-group"><label>Item 5</label><input type="text" id="f-inv-5"></div>
          <div class="input-group"><label>Item 6</label><input type="text" id="f-inv-6"></div>
        </div>
        <hr style="border-color: var(--glass); margin: 15px 0;">
        <div class="input-group">
          <label for="f-biografia">Biografia</label>
          <textarea id="f-biografia" placeholder="A história do seu personagem..."></textarea>
        </div>
      </fieldset>
    </div>

    <div id="output-container">
      <textarea id="output-code" readonly>O HTML minificado da sua ficha aparecerá aqui...</textarea>
      <button id="copy-btn">Copiar Código</button>
    </div>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', function() {
      
      const form = document.getElementById('form-container');
      const copyBtn = document.getElementById('copy-btn');
      const outputArea = document.getElementById('output-code');
      const allInputs = form.querySelectorAll('input, textarea, select');
      const storageKey = 'jjkFichaGeneratorData_v14'; // Chave atualizada

      // MAPA DE APTIDÕES ATUALIZADO (USA idBase)
      const aptidoesMap = {
        forca: [
          { idBase: 'f-skill-combate-desarmado', label: 'Combate Desarmado' },
          { idBase: 'f-skill-espadas-longas', label: 'Espadas Longas' },
          { idBase: 'f-skill-machados-longos', label: 'Machados Longos' },
          { idBase: 'f-skill-martelos-longos', label: 'Martelos Longos' },
          { idBase: 'f-skill-clavas', label: 'Clavas' },
          { idBase: 'f-skill-escalada', label: 'Escalada' },
          { idBase: 'f-skill-acrobacia', label: 'Acrobacia' }
        ],
        destreza: [
          { idBase: 'f-skill-espadas-curtas', label: 'Espadas Curtas' },
          { idBase: 'f-skill-adagas', label: 'Adagas' },
          { idBase: 'f-skill-laminas-duplas', label: 'Lâminas Duplas' },
          { idBase: 'f-skill-machados-curtos', label: 'Machados Curtos' },
          { idBase: 'f-skill-martelos-curtos', label: 'Martelos Curtos' },
          { idBase: 'f-skill-lancas', label: 'Lanças' },
          { idBase: 'f-skill-foices', label: 'Foices' },
          { idBase: 'f-skill-bastoes', label: 'Bastões' },
          { idBase: 'f-skill-correntes', label: 'Correntes e Kusarigama' },
          { idBase: 'f-skill-arremesso', label: 'Arremesso de Armas' },
          { idBase: 'f-skill-armas-de-fogo', label: 'Armas de Fogo' },
          { idBase: 'f-skill-furtividade', label: 'Furtividade' },
          { idBase: 'f-skill-natacao', label: 'Natação' },
          { idBase: 'f-skill-corrida', label: 'Corrida' }
        ],
        inteligencia: [
          { idBase: 'f-skill-feiticos', label: 'Feitiços' },
          { idBase: 'f-skill-barreiras', label: 'Barreiras' },
          { idBase: 'f-skill-pactos', label: 'Pactos' },
          { idBase: 'f-skill-percepcao-magica', label: 'Percepção Mágica' },
          { idBase: 'f-skill-primeiros-socorros', label: 'Primeiros Socorros' },
          { idBase: 'f-skill-tecnica-reversa', label: 'Técnica Reversa' },
          { idBase: 'f-skill-percepcao-visual', label: 'Percepção Visual' },
          { idBase: 'f-skill-sobrevivencia', label: 'Sobrevivência' }
        ]
      };
      
      const MAX_SLOTS = {
        tecnicas: 5,
        relacoes: 3,
        inventario: 6
      };

      function getVal(id) { return document.getElementById(id).value.trim(); }
      function getNum(id) { return parseInt(document.getElementById(id).value, 10) || 0; }
      function escapeHTML(str) { if (!str) return ''; return str.replace(/</g, "&lt;").replace(/>/g, "&gt;"); }
      function escapeAttr(str) { if (!str) return ''; return str.replace(/"/g, "&quot;"); }

      function parseListSimple(textareaId) {
        const text = getVal(textareaId);
        if (!text) return '<li>...</li>';
        return text.split('\n')
                   .filter(line => line.trim() !== '')
                   .map(line => '<li>' + escapeHTML(line.trim()) + '</li>')
                   .join('');
      }
      
      function parseListLinks(baseId, maxSlots) {
        let html = '';
        for (let i = 1; i <= maxSlots; i++) {
          const nome = getVal(baseId + '-nome-' + i);
          const url = getVal(baseId + '-url-' + i);
          if (nome) {
            if (url) {
              html += '<li>[url=' + escapeAttr(url) + ']' + escapeHTML(nome) + '[/url]</li>';
            } else {
              html += '<li>' + escapeHTML(nome) + '</li>';
            }
          }
        }
        return html || '<li>...</li>';
      }
      
      function parseParticularidade() {
        const nome = getVal('f-particularidade-nome');
        if (!nome) return '<li>Nenhuma</li>';
        const url = getVal('f-particularidade-url');
        const desc = escapeHTML(getVal('f-particularidade-desc'));
        let linkContent = escapeHTML(nome);
        if (url) {
          linkContent = '[url=' + escapeAttr(url) + ']' + escapeHTML(nome) + '[/url]';
        }
        return '<li>[b]' + linkContent + ':[/b] ' + desc + '</li>';
      }
      
      function parseRelacoes(baseId, maxSlots) {
        let html = '';
        for (let i = 1; i <= maxSlots; i++) {
          const nome = getVal(baseId + '-nome-' + i);
          const status = getVal(baseId + '-status-' + i);
          const desc = getVal(baseId + '-desc-' + i);
          if (nome) {
            html += '<div class="jjk-dossier-relation-card"><div class="jjk-dossier-relation-header"><div class="jjk-dossier-relation-name">' + escapeHTML(nome) + '</div><div class="jjk-dossier-relation-status">' + escapeHTML(status) + '</div></div><div class="jjk-dossier-relation-body">' + escapeHTML(desc) + '</div></div>';
          }
        }
        return html || '<div class="jjk-dossier-relation-card"><div class="jjk-dossier-relation-header"><div class="jjk-dossier-relation-name">...</div></div></div>';
      }
      
      function parseInventario(baseId, maxSlots) {
        let html = '';
        for (let i = 1; i <= maxSlots; i++) {
          const val = getVal(baseId + '-' + i);
          if (val) {
            const parts = val.split('|');
            const nome = escapeHTML((parts[0] || 'Item').trim());
            const desc = escapeHTML((parts[1] || '...').trim());
            html += '<div class="jjk-dossier-inventory-item"><span>' + nome + '</span><div class="jjk-dossier-tooltip-text">' + desc + '</div></div>';
          }
        }
        return html || '<div class="jjk-dossier-inventory-item"><span>...</span></div>';
      }
      
      // FUNÇÃO DE APTIDÕES ATUALIZADA
      function gerarAptidoesHTML(tipo) {
        return aptidoesMap[tipo].map(apt => {
          const baseId = apt.idBase;
          const label = apt.label;
          const nivel = getNum(baseId + '-lvl');
          const xp = escapeHTML(getVal(baseId + '-xp'));
          
          return '<div class="jjk-dossier-skill-item">' +
                   '<div class="jjk-dossier-skill-info">' +
                     '<span class="jjk-dossier-skill-name">' + label + '</span>' +
                     '<span class="jjk-dossier-skill-level">' + nivel + '</span>' +
                   '</div>' +
                   '<span class="jjk-dossier-skill-xp">' + xp + '</span>' +
                   '<div class="jjk-dossier-skill-bar-wrapper">' +
                     '<div class="jjk-dossier-skill-bar-fill"></div>' +
                   '</div>' +
                 '</div>';
        }).join('');
      }

      function generateAndDisplayHTML() {
        try {
          const charName = escapeHTML(getVal('f-char-name'));
          const charTitle = escapeHTML(getVal('f-char-title'));
          const profileImg = escapeAttr(getVal('f-profile-img'));
          const idade = escapeHTML(getVal('f-idade'));
          const grau = escapeHTML(getVal('f-grau'));
          const afiliacao = escapeHTML(getVal('f-afiliacao'));
          const alinhamento = escapeHTML(getVal('f-alinhamento'));
          
          // LÓGICA DE HP/EA/REGEN ATUALIZADA
          const hpAtual = getNum('f-hp-atual');
          const hpMax = getNum('f-hp-max');
          const eaAtual = getNum('f-ea-atual');
          const eaMax = getNum('f-ea-max');
          const regenTotal = getNum('f-regen-ea');
          
          const forca = getNum('f-forca');
          const destreza = getNum('f-destreza');
          const inteligencia = getNum('f-inteligencia');
          const sorte = getNum('f-sorte');
          const vigor = getNum('f-vigor');
          const energia = getNum('f-energia');
          const fonte = getNum('f-fonte');
          
          const aptForcaHtml = gerarAptidoesHTML('forca');
          const aptDestrezaHtml = gerarAptidoesHTML('destreza');
          const aptInteligenciaHtml = gerarAptidoesHTML('inteligencia');
          
          const tecnicasHtml = parseListLinks('f-tecnica', MAX_SLOTS.tecnicas);
          const equipamentosHtml = parseListSimple('f-equipamentos');
          const caracPHtml = parseListSimple('f-carac-p');
          const caracNHtml = parseListSimple('f-carac-n');
          const particularidadeHtml = parseParticularidade();
          
          const aparencia = escapeHTML(getVal('f-aparencia'));
          const altura = escapeHTML(getVal('f-altura'));
          const peso = escapeHTML(getVal('f-peso'));
          const olhos = escapeHTML(getVal('f-olhos'));
          const cabelo = escapeHTML(getVal('f-cabelo'));
          const pele = escapeHTML(getVal('f-pele'));

          const gostosHtml = parseListSimple('f-gostos');
          const desgostosHtml = parseListSimple('f-desgostos');
          const medosHtml = parseListSimple('f-medos');
          const objetivosHtml = parseListSimple('f-objetivos');
          
          const relacoesHtml = parseRelacoes('f-rel', MAX_SLOTS.relacoes);
          const inventarioHtml = parseInventario('f-inv', MAX_SLOTS.inventario);
          const biografia = escapeHTML(getVal('f-biografia'));

          // String HTML ATUALIZADA com os novos valores de HP/EA/Regen
          var finalHTML = '<link href="https://gaaaaaaaaabs.github.io/goldenagerepositor.io/ficha.css" rel="stylesheet" type="text/css"><div class="jjk-dossier-container"><input type="radio" name="dossier-tab" id="dossier-tab-1" style="display:none;"><input type="radio" name="dossier-tab" id="dossier-tab-2" style="display:none;"><input type="radio" name="dossier-tab" id="dossier-tab-3" style="display:none;"><input type="radio" name="dossier-tab" id="dossier-tab-4" checked="" style="display:none;"><input type="radio" name="dossier-tab" id="dossier-tab-5" style="display:none;"><input type="radio" name="dossier-tab" id="dossier-tab-6" style="display:none;"><input type="radio" name="dossier-tab" id="dossier-tab-7" style="display:none;"><input type="radio" name="dossier-tab" id="dossier-tab-8" style="display:none;"><div class="jjk-dossier-id-card"><div class="jjk-dossier-profile-img-wrapper"><img src="' + profileImg + '" class="jjk-dossier-profile-img"><div class="jjk-dossier-particle"></div><div class="jjk-dossier-particle"></div><div class="jjk-dossier-particle"></div><div class="jjk-dossier-particle"></div><div class="jjk-dossier-particle"></div></div><div class="jjk-dossier-profile-info"><h1 class="jjk-dossier-char-name">' + charName + '</h1><p class="jjk-dossier-char-title">' + charTitle + '</p><div class="jjk-dossier-status-bars"><div class="jjk-dossier-status-item"><span class="jjk-dossier-status-label">HP</span><div class="jjk-dossier-status-bar-wrapper"><div class="jjk-dossier-status-bar"><div class="jjk-dossier-status-bar-fill jjk-dossier-hp-fill"></div></div><span class="jjk-dossier-status-value">' + hpAtual + ' / ' + hpMax + '</span></div></div><div class="jjk-dossier-status-item"><span class="jjk-dossier-status-label">EA</span><div class="jjk-dossier-status-bar-wrapper"><div class="jjk-dossier-status-bar"><div class="jjk-dossier-status-bar-fill jjk-dossier-ea-fill"></div></div><span class="jjk-dossier-status-value">' + eaAtual + ' / ' + eaMax + '</span></div></div></div><div class="jjk-dossier-info-grid"><div class="jjk-dossier-info-box"><div class="jjk-dossier-label">Idade</div><div class="jjk-dossier-value">' + idade + '</div></div><div class="jjk-dossier-info-box"><div class="jjk-dossier-label">Grau</div><div class="jjk-dossier-value">' + grau + '</div></div><div class="jjk-dossier-info-box"><div class="jjk-dossier-label">Afiliação</div><div class="jjk-dossier-value">' + afiliacao + '</div></div><div class="jjk-dossier-info-box"><div class="jjk-dossier-label">Alinhamento</div><div class="jjk-dossier-value">' + alinhamento + '</div></div><div class="jjk-dossier-info-box"><div class="jjk-dossier-label">Regen. EA</div><div class="jjk-dossier-value">' + regenTotal + ' / Turno</div></div></div></div></div><div class="jjk-dossier-body"><nav class="jjk-dossier-tabs-nav"><label for="dossier-tab-4" id="dossier-tab-4-label" class="jjk-dossier-tab-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path><circle cx="12" cy="7" r="4"></circle></svg>Perfil</label><label for="dossier-tab-1" id="dossier-tab-1-label" class="jjk-dossier-tab-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><path d="M12 8V12L14 14"></path><circle cx="12" cy="12" r="10"></circle><path d="M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10 10-4.5 10-10S17.5 2 12 2zM8 6c0-1.1.9-2 2-2M14 6c0-1.1.9-2 2-2"></path></svg>Atributos</label><label for="dossier-tab-2" id="dossier-tab-2-label" class="jjk-dossier-tab-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><path d="M12 14l9-5-9-5-9 5 9 5z"></path><path d="M12 14l6.16-3.422 A12 12 0 0 1 12 22a12 12 0 0 1-6.16-11.422L12 14z"></path><path d="M12 14l9-5-9-5-9 5 9 5z"></path></svg>Aptidões</label><label for="dossier-tab-8" id="dossier-tab-8-label" class="jjk-dossier-tab-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"></polygon></svg>Características</label><label for="dossier-tab-3" id="dossier-tab-3-label" class="jjk-dossier-tab-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><path d="M15.5 8.5L18 6l-2.5-2.5"></path><path d="M8.5 15.5L6 18l2.5 2.5"></path><path d="M12 2v20"></path><path d="M2 12h20"></path></svg>Combate</label><label for="dossier-tab-5" id="dossier-tab-5-label" class="jjk-dossier-tab-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path><circle cx="9" cy="7" r="4"></circle><path d="M23 21v-2a4 4 0 0 0-3-3.87"></path><path d="M16 3.13a4 4 0 0 1 0 7.75"></path></svg>Relações</label><label for="dossier-tab-6" id="dossier-tab-6-label" class="jjk-dossier-tab-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><path d="M6 2L3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-2z"></path><line x1="3" y1="6" x2="21" y2="6"></line><path d="M16 10a4 4 0 0 1-8 0"></path></svg>Inventário</label><label for="dossier-tab-7" id="dossier-tab-7-label" class="jjk-dossier-tab-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"></path><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"></path></svg>Biografia</label></nav><div id="dossier-content-1" class="jjk-dossier-tab-content" role="tabpanel" aria-labelledby="dossier-tab-1-label"><h3>Atributos Principais</h3><div class="jjk-dossier-attr-grid"><div class="jjk-dossier-attr-item"><div class="jjk-dossier-attr-header"><span class="jjk-dossier-attr-name">Força</span><span class="jjk-dossier-attr-value">' + forca + ' / 20</span></div><div class="jjk-dossier-attr-bar"><div class="jjk-dossier-attr-bar-fill"></div></div></div><div class="jjk-dossier-attr-item"><div class="jjk-dossier-attr-header"><span class="jjk-dossier-attr-name">Destreza</span><span class="jjk-dossier-attr-value">' + destreza + ' / 20</span></div><div class="jjk-dossier-attr-bar"><div class="jjk-dossier-attr-bar-fill"></div></div></div><div class="jjk-dossier-attr-item"><div class="jjk-dossier-attr-header"><span class="jjk-dossier-attr-name">Inteligência</span><span class="jjk-dossier-attr-value">' + inteligencia + ' / 20</span></div><div class="jjk-dossier-attr-bar"><div class="jjk-dossier-attr-bar-fill"></div></div></div><div class="jjk-dossier-attr-item"><div class="jjk-dossier-attr-header"><span class="jjk-dossier-attr-name">Sorte</span><span class="jjk-dossier-attr-value">' + sorte + ' / 20</span></div><div class="jjk-dossier-attr-bar"><div class="jjk-dossier-attr-bar-fill"></div></div></div></div><h3 style="margin-top:25px;">Atributos Especiais</h3><div class="jjk-dossier-attr-grid"><div class="jjk-dossier-attr-item"><div class="jjk-dossier-attr-header"><span class="jjk-dossier-attr-name">Vigor (HP)</span><span class="jjk-dossier-attr-value">' + vigor + ' / 20</span></div><div class="jjk-dossier-attr-bar"><div class="jjk-dossier-attr-bar-fill"></div></div></div><div class="jjk-dossier-attr-item"><div class="jjk-dossier-attr-header"><span class="jjk-dossier-attr-name">Energia (EA)</span><span class="jjk-dossier-attr-value">' + energia + ' / 20</span></div><div class="jjk-dossier-attr-bar"><div class="jjk-dossier-attr-bar-fill"></div></div></div><div class="jjk-dossier-attr-item"><div class="jjk-dossier-attr-header"><span class="jjk-dossier-attr-name">Fonte (Regen. EA)</span><span class="jjk-dossier-attr-value">' + fonte + ' / 20</span></div><div class="jjk-dossier-attr-bar"><div class="jjk-dossier-attr-bar-fill"></div></div></div></div></div><div id="dossier-content-2" class="jjk-dossier-tab-content" role="tabpanel" aria-labelledby="dossier-tab-2-label"><h3>Aptidões</h3><div class="jjk-dossier-accordion"><div class="jjk-dossier-accordion-item"><input type="checkbox" id="skill-for-v4"><label for="skill-for-v4" class="jjk-dossier-accordion-title">Força (FOR)</label><div class="jjk-dossier-skill-list">' + aptForcaHtml + '</div></div><div class="jjk-dossier-accordion-item"><input type="checkbox" id="skill-des-v4"><label for="skill-des-v4" class="jjk-dossier-accordion-title">Destreza (DES)</label><div class="jjk-dossier-skill-list">' + aptDestrezaHtml + '</div></div><div class="jjk-dossier-accordion-item"><input type="checkbox" id="skill-int-v4"><label for="skill-int-v4" class="jjk-dossier-accordion-title">Inteligência (INT)</label><div class="jjk-dossier-skill-list">' + aptInteligenciaHtml + '</div></div></div></div><div id="dossier-content-3" class="jjk-dossier-tab-content" role="tabpanel" aria-labelledby="dossier-tab-3-label"><div class="jjk-dossier-combat-grid"><div><h3>Técnicas</h3><div class="jjk-dossier-combat-box"><ul>' + tecnicasHtml + '</ul></div></div><div><h3>Equipamentos</h3><div class="jjk-dossier-combat-box"><ul>' + equipamentosHtml + '</ul></div></div></div></div><div id="dossier-content-8" class="jjk-dossier-tab-content" role="tabpanel" aria-labelledby="dossier-tab-8-label"><div class="jjk-dossier-combat-grid"><div><h3>Características Positivas</h3><div class="jjk-dossier-combat-box"><ul>' + caracPHtml + '</ul></div></div><div><h3>Características Negativas</h3><div class="jjk-dossier-combat-box"><ul>' + caracNHtml + '</ul></div></div></div></div><div id="dossier-content-4" class="jjk-dossier-tab-content" role="tabpanel" aria-labelledby="dossier-tab-4-label"><div class="jjk-dossier-profile-section"><div class="jjk-dossier-profile-desc"><h3>Aparência Geral</h3><p>' + aparencia + '</p></div><div class="jjk-dossier-profile-stats"><div class="jjk-dossier-profile-item"><div class="jjk-dossier-profile-label">Altura</div><div class="jjk-dossier-profile-value">' + altura + '</div></div><div class="jjk-dossier-profile-item"><div class="jjk-dossier-profile-label">Peso</div><div class="jjk-dossier-profile-value">' + peso + '</div></div><div class="jjk-dossier-profile-item"><div class="jjk-dossier-profile-label">Olhos</div><div class="jjk-dossier-profile-value">' + olhos + '</div></div><div class="jjk-dossier-profile-item"><div class="jjk-dossier-profile-label">Cabelo</div><div class="jjk-dossier-profile-value">' + cabelo + '</div></div><div class="jjk-dossier-profile-item"><div class="jjk-dossier-profile-label">Pele</div><div class="jjk-dossier-profile-value">' + pele + '</div></div></div></div><h3 style="margin-top:25px;">Particularidade</h3><div class="jjk-dossier-combat-box"><ul>' + particularidadeHtml + '</ul></div><h3 style="margin-top:25px;">Perfil Psicológico</h3><div class="jjk-dossier-psyche-grid"><div class="jjk-dossier-psyche-card"><h4><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path></svg>Gostos</h4><ul class="jjk-dossier-scrollable">' + gostosHtml + '</ul></div><div class="jjk-dossier-psyche-card"><h4><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><line x1="4.93" y1="4.93" x2="19.07" y2="19.07"></line></svg>Desgostos</h4><ul class="jjk-dossier-scrollable">' + desgostosHtml + '</ul></div><div class="jjk-dossier-psyche-card"><h4><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"></path></svg>Medos</h4><ul class="jjk-dossier-scrollable">' + medosHtml + '</ul></div><div class="jjk-dossier-psyche-card"><h4><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><circle cx="12" cy="12" r="6"></circle><circle cx="12" cy="12" r="2"></circle></svg>Objetivos</h4><ul class="jjk-dossier-scrollable">' + objetivosHtml + '</ul></div></div></div><div id="dossier-content-5" class="jjk-dossier-tab-content" role="tabpanel" aria-labelledby="dossier-tab-5-label"><h3>Relações</h3><div class="jjk-dossier-relations-grid">' + relacoesHtml + '</div></div><div id="dossier-content-6" class="jjk-dossier-tab-content" role="tabpanel" aria-labelledby="dossier-tab-6-label"><h3>Inventário</h3><div class="jjk-dossier-inventory-grid">' + inventarioHtml + '</div></div><div id="dossier-content-7" class="jjk-dossier-tab-content" role="tabpanel" aria-labelledby="dossier-tab-7-label"><h3>Biografia</h3><p class="jjk-dossier-bio-text">' + biografia + '</p></div></div></div>';

          outputArea.value = finalHTML;
        
        } catch (e) {
          console.error("Erro ao gerar HTML:", e);
          outputArea.value = "Erro! Verifique os valores do formulário. Detalhes no console (F12).";
        }
      }
      
      function saveDataToLocalStorage() {
        const data = {};
        allInputs.forEach(input => {
          if(input.id) {
            data[input.id] = input.value;
          }
        });
        localStorage.setItem(storageKey, JSON.stringify(data));
      }

      function loadDataFromLocalStorage() {
        const data = JSON.parse(localStorage.getItem(storageKey));
        if (data) {
          allInputs.forEach(input => {
            if (input.id && data[input.id] !== undefined) {
              input.value = data[input.id];
            }
          });
        }
        generateAndDisplayHTML();
      }

      // --- SCRIPT DE ALTURA DO IFRAME ---
      const targetOrigin = 'https://goldenagejjkrpg.forumeiros.com';
      
      function sendHeight() {
        var newHeight = document.documentElement.scrollHeight;
        window.parent.postMessage({ frameHeight: newHeight }, targetOrigin);
      }

      const resizeObserver = new ResizeObserver(entries => {
        sendHeight();
      });
      resizeObserver.observe(document.body);
      
      // --- EVENT LISTENERS ---
      loadDataFromLocalStorage();

      form.addEventListener('input', function(event) {
        generateAndDisplayHTML();
        saveDataToLocalStorage();
        sendHeight(); 
      });

      copyBtn.addEventListener('click', function() {
        outputArea.select();
        document.execCommand('copy');
        copyBtn.textContent = 'Copiado!';
        setTimeout(() => {
          copyBtn.textContent = 'Copiar Código';
        }, 2000);
      });
      
      sendHeight();

    });
  </script>
</body>
</html>
